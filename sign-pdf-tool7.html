<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Free online PDF signing tool. Upload your PDF, add your signature, and download the signed document instantly.">
    <meta name="keywords" content="PDF sign, digital signature, sign PDF online, PDF tool, document signing">
    <title>SignPDF Pro | Free Online PDF Signing Tool</title>
    <style>
        :root {
            --primary: #4361ee;
            --primary-dark: #3a56d4;
            --secondary: #7209b7;
            --accent: #f72585;
            --light: #f8f9fa;
            --dark: #212529;
            --gray: #6c757d;
            --success: #4bb543;
            --border-radius: 8px;
            --box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f7fb;
            color: var(--dark);
            line-height: 1.6;
        }

        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 1.5rem 0;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo i {
            font-size: 1.8rem;
        }

        .logo h1 {
            font-size: 1.5rem;
            font-weight: 700;
        }

        nav ul {
            display: flex;
            list-style: none;
            gap: 1.5rem;
        }

        nav a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            transition: var(--transition);
        }

        nav a:hover {
            color: rgba(255, 255, 255, 0.8);
        }

        .hero {
            text-align: center;
            padding: 3rem 0;
            background-color: white;
            margin-bottom: 2rem;
            border-radius: 0 0 var(--border-radius) var(--border-radius);
            box-shadow: var(--box-shadow);
        }

        .hero h2 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            color: var(--dark);
        }

        .hero p {
            font-size: 1.1rem;
            color: var(--gray);
            max-width: 700px;
            margin: 0 auto 2rem;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 300px;
            gap: 2rem;
            margin-bottom: 3rem;
        }

        @media (max-width: 992px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }

        .tool-container {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            overflow: hidden;
        }

        .tool-header {
            background: var(--primary);
            color: white;
            padding: 1.2rem;
            text-align: center;
            font-weight: 600;
            font-size: 1.2rem;
        }

        .tool-body {
            padding: 2rem;
        }

        .step {
            margin-bottom: 2.5rem;
            display: none;
        }

        .step.active {
            display: block;
        }

        .step-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 1.5rem;
            padding-bottom: 0.8rem;
            border-bottom: 1px solid #eaeaea;
        }

        .step-number {
            background: var(--primary);
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
        }

        .step-title {
            font-size: 1.3rem;
            font-weight: 600;
        }

        .upload-area {
            border: 2px dashed #d1d5db;
            border-radius: var(--border-radius);
            padding: 3rem 2rem;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            margin-bottom: 1.5rem;
        }

        .upload-area:hover {
            border-color: var(--primary);
            background-color: rgba(67, 97, 238, 0.05);
        }

        .upload-area i {
            font-size: 3rem;
            color: var(--gray);
            margin-bottom: 1rem;
        }

        .upload-area h3 {
            font-size: 1.3rem;
            margin-bottom: 0.5rem;
        }

        .upload-area p {
            color: var(--gray);
            margin-bottom: 1rem;
        }

        .btn {
            display: inline-block;
            background: var(--primary);
            color: white;
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: var(--border-radius);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            text-align: center;
        }

        .btn:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: var(--secondary);
        }

        .btn-secondary:hover {
            background: #6511a0;
        }

        .btn-success {
            background: var(--success);
        }

        .btn-success:hover {
            background: #3f9c38;
        }

        .btn-outline {
            background: transparent;
            border: 1px solid var(--primary);
            color: var(--primary);
        }

        .btn-outline:hover {
            background: rgba(67, 97, 238, 0.1);
        }

        .file-info {
            background: #f8f9fa;
            padding: 1rem;
            border-radius: var(--border-radius);
            margin-top: 1rem;
            display: none;
        }

        .file-info.active {
            display: block;
        }

        .signature-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .signature-option {
            border: 1px solid #eaeaea;
            border-radius: var(--border-radius);
            padding: 1.5rem;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
        }

        .signature-option:hover {
            border-color: var(--primary);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .signature-option.active {
            border-color: var(--primary);
            background: rgba(67, 97, 238, 0.05);
        }

        .signature-option i {
            font-size: 2rem;
            color: var(--primary);
            margin-bottom: 0.8rem;
        }

        .canvas-container {
            border: 1px solid #eaeaea;
            border-radius: var(--border-radius);
            margin-bottom: 1rem;
            overflow: hidden;
        }

        #signatureCanvas {
            width: 100%;
            height: 200px;
            background: white;
            cursor: crosshair;
        }

        .canvas-controls {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .preview-container {
            border: 1px solid #eaeaea;
            border-radius: var(--border-radius);
            height: 400px;
            overflow: auto;
            margin-bottom: 1.5rem;
            background: #f9f9f9;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .preview-container img {
            max-width: 100%;
            max-height: 100%;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .signature-position {
            position: absolute;
            border: 2px dashed var(--primary);
            padding: 5px;
            background: rgba(255, 255, 255, 0.8);
            cursor: move;
            display: none;
        }

        .tool-footer {
            display: flex;
            justify-content: space-between;
            padding: 1.5rem 2rem;
            border-top: 1px solid #eaeaea;
            background: #f8f9fa;
        }

        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .ad-container {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            overflow: hidden;
        }

        .ad-header {
            background: #f1f3f4;
            padding: 0.8rem 1rem;
            font-weight: 600;
            color: var(--gray);
            text-align: center;
            font-size: 0.9rem;
        }

        .ad-content {
            padding: 1.5rem;
            min-height: 250px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #f8f9fa;
        }

        .ad-content p {
            color: var(--gray);
            text-align: center;
        }

        .info-box {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 1.5rem;
        }

        .info-box h3 {
            margin-bottom: 1rem;
            color: var(--primary);
            font-size: 1.2rem;
        }

        .info-box ul {
            list-style: none;
        }

        .info-box li {
            margin-bottom: 0.8rem;
            padding-left: 1.5rem;
            position: relative;
        }

        .info-box li:before {
            content: "✓";
            position: absolute;
            left: 0;
            color: var(--success);
            font-weight: bold;
        }

        footer {
            background: var(--dark);
            color: white;
            padding: 3rem 0 2rem;
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .footer-section h3 {
            margin-bottom: 1.2rem;
            font-size: 1.2rem;
        }

        .footer-section ul {
            list-style: none;
        }

        .footer-section li {
            margin-bottom: 0.7rem;
        }

        .footer-section a {
            color: #adb5bd;
            text-decoration: none;
            transition: var(--transition);
        }

        .footer-section a:hover {
            color: white;
        }

        .copyright {
            text-align: center;
            padding-top: 1.5rem;
            border-top: 1px solid #495057;
            color: #adb5bd;
            font-size: 0.9rem;
        }

        .mobile-nav-toggle {
            display: none;
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
        }

        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 1rem;
            }

            nav ul {
                flex-direction: column;
                text-align: center;
                gap: 1rem;
            }

            .hero h2 {
                font-size: 2rem;
            }

            .tool-footer {
                flex-direction: column;
                gap: 1rem;
            }

            .mobile-nav-toggle {
                display: block;
            }

            .nav-menu {
                display: none;
                width: 100%;
            }

            .nav-menu.active {
                display: block;
            }
        }

        .progress-bar {
            height: 6px;
            background: #eaeaea;
            border-radius: 3px;
            margin-bottom: 2rem;
            overflow: hidden;
        }

        .progress {
            height: 100%;
            background: var(--primary);
            width: 0%;
            transition: width 0.5s ease;
        }

        .success-message {
            text-align: center;
            padding: 2rem;
            display: none;
        }

        .success-message i {
            font-size: 4rem;
            color: var(--success);
            margin-bottom: 1.5rem;
        }

        .success-message h3 {
            font-size: 1.8rem;
            margin-bottom: 1rem;
            color: var(--success);
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-file-signature"></i>
                    <h1>SignPDF Pro</h1>
                </div>
                <button class="mobile-nav-toggle">
                    <i class="fas fa-bars"></i>
                </button>
                <nav class="nav-menu">
                    <ul>
                        <li><a href="#">Home</a></li>
                        <li><a href="#">How It Works</a></li>
                        <li><a href="#">Features</a></li>
                        <li><a href="#">Pricing</a></li>
                        <li><a href="#">Contact</a></li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>

    <section class="hero">
        <div class="container">
            <h2>Sign PDF Documents Online for Free</h2>
            <p>Upload your PDF, add your signature, and download the signed document in seconds. No registration required.</p>
            <div class="progress-bar">
                <div class="progress" id="progressBar"></div>
            </div>
        </div>
    </section>

    <div class="container">
        <div class="main-content">
            <div class="tool-container">
                <div class="tool-header">
                    PDF Signing Tool
                </div>
                <div class="tool-body">
                    <!-- Step 1: Upload PDF -->
                    <div class="step active" id="step1">
                        <div class="step-header">
                            <div class="step-number">1</div>
                            <div class="step-title">Upload Your PDF</div>
                        </div>
                        <div class="upload-area" id="uploadArea">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <h3>Upload Your PDF Document</h3>
                            <p>Drag & drop your file here or click to browse</p>
                            <p class="small">Maximum file size: 10MB</p>
                            <button class="btn btn-secondary" id="browseBtn">Browse Files</button>
                            <input type="file" id="fileInput" accept=".pdf" style="display: none;">
                        </div>
                        <div class="file-info" id="fileInfo">
                            <div class="file-details">
                                <h4>Selected File:</h4>
                                <p id="fileName"></p>
                                <p id="fileSize"></p>
                            </div>
                            <button class="btn" id="continueBtn1">Continue</button>
                        </div>
                    </div>

                    <!-- Step 2: Create Signature -->
                    <div class="step" id="step2">
                        <div class="step-header">
                            <div class="step-number">2</div>
                            <div class="step-title">Create Your Signature</div>
                        </div>
                        <p>Choose how you'd like to create your signature:</p>
                        
                        <div class="signature-options">
                            <div class="signature-option active" data-type="draw">
                                <i class="fas fa-pen"></i>
                                <h4>Draw Signature</h4>
                                <p>Draw your signature with mouse or touch</p>
                            </div>
                            <div class="signature-option" data-type="type">
                                <i class="fas fa-font"></i>
                                <h4>Type Signature</h4>
                                <p>Type your name and choose a font</p>
                            </div>
                            <div class="signature-option" data-type="upload">
                                <i class="fas fa-upload"></i>
                                <h4>Upload Image</h4>
                                <p>Upload an image of your signature</p>
                            </div>
                        </div>

                        <!-- Drawing Canvas -->
                        <div class="signature-method" id="drawMethod">
                            <div class="canvas-container">
                                <canvas id="signatureCanvas"></canvas>
                            </div>
                            <div class="canvas-controls">
                                <button class="btn btn-outline" id="clearCanvas">
                                    <i class="fas fa-eraser"></i> Clear
                                </button>
                                <button class="btn btn-outline" id="undoCanvas">
                                    <i class="fas fa-undo"></i> Undo
                                </button>
                                <select id="penColor" class="btn-outline">
                                    <option value="black">Black</option>
                                    <option value="blue">Blue</option>
                                    <option value="red">Red</option>
                                </select>
                                <select id="penWidth" class="btn-outline">
                                    <option value="2">Thin</option>
                                    <option value="4" selected>Medium</option>
                                    <option value="6">Thick</option>
                                </select>
                            </div>
                        </div>

                        <!-- Type Signature -->
                        <div class="signature-method" id="typeMethod" style="display: none;">
                            <div class="form-group">
                                <label for="signatureText">Enter Your Name</label>
                                <input type="text" id="signatureText" placeholder="John Doe" class="btn-outline" style="width: 100%; padding: 0.8rem; margin-bottom: 1rem;">
                            </div>
                            <div class="form-group">
                                <label for="signatureFont">Select Font Style</label>
                                <select id="signatureFont" class="btn-outline" style="width: 100%; padding: 0.8rem;">
                                    <option value="Dancing Script">Dancing Script</option>
                                    <option value="Great Vibes">Great Vibes</option>
                                    <option value="Parisienne">Parisienne</option>
                                    <option value="Allura">Allura</option>
                                    <option value="Satisfy">Satisfy</option>
                                </select>
                            </div>
                            <div class="signature-preview">
                                <p>Signature Preview:</p>
                                <div id="typedSignaturePreview" style="border: 1px dashed #ccc; padding: 1rem; min-height: 80px; display: flex; align-items: center; justify-content: center; font-family: 'Dancing Script', cursive; font-size: 1.5rem;">
                                    Your signature will appear here
                                </div>
                            </div>
                        </div>

                        <!-- Upload Signature -->
                        <div class="signature-method" id="uploadMethod" style="display: none;">
                            <div class="upload-area" id="signatureUploadArea" style="padding: 2rem;">
                                <i class="fas fa-file-image"></i>
                                <h3>Upload Signature Image</h3>
                                <p>PNG, JPG with transparent background recommended</p>
                                <button class="btn btn-secondary" id="browseSignatureBtn">Browse Images</button>
                                <input type="file" id="signatureFileInput" accept=".png,.jpg,.jpeg" style="display: none;">
                            </div>
                            <div class="file-info" id="signatureFileInfo" style="display: none;">
                                <div class="file-details">
                                    <h4>Selected Image:</h4>
                                    <p id="signatureFileName"></p>
                                </div>
                            </div>
                        </div>

                        <div class="tool-footer">
                            <button class="btn btn-outline" id="backBtn1">Back</button>
                            <button class="btn" id="continueBtn2">Continue</button>
                        </div>
                    </div>

                    <!-- Step 3: Position Signature -->
                    <div class="step" id="step3">
                        <div class="step-header">
                            <div class="step-number">3</div>
                            <div class="step-title">Position Your Signature</div>
                        </div>
                        <p>Drag the signature to the desired position on the document:</p>
                        
                        <div class="preview-container" id="previewContainer">
                            <p>PDF preview will appear here</p>
                            <div class="signature-position" id="signaturePosition">
                                <div id="signaturePreview"></div>
                            </div>
                        </div>

                        <div class="tool-footer">
                            <button class="btn btn-outline" id="backBtn2">Back</button>
                            <button class="btn" id="continueBtn3">Sign & Download</button>
                        </div>
                    </div>

                    <!-- Success Message -->
                    <div class="success-message" id="successMessage">
                        <i class="fas fa-check-circle"></i>
                        <h3>PDF Successfully Signed!</h3>
                        <p>Your document has been signed and is ready for download.</p>
                        <button class="btn btn-success" id="downloadBtn">
                            <i class="fas fa-download"></i> Download Signed PDF
                        </button>
                        <div style="margin-top: 2rem;">
                            <button class="btn btn-outline" id="newDocumentBtn">
                                <i class="fas fa-plus"></i> Sign Another Document
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="sidebar">
                <div class="ad-container">
                    <div class="ad-header">Advertisement</div>
                    <div class="ad-content">
                        <!-- Google AdSense Ad Unit -->
                        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-XXXXXXXXXXXXXXXX" crossorigin="anonymous"></script>
                        <ins class="adsbygoogle"
                             style="display:block"
                             data-ad-client="ca-pub-XXXXXXXXXXXXXXXX"
                             data-ad-slot="XXXXXXXXXX"
                             data-ad-format="auto"
                             data-full-width-responsive="true"></ins>
                        <script>
                             (adsbygoogle = window.adsbygoogle || []).push({});
                        </script>
                    </div>
                </div>

                <div class="info-box">
                    <h3>Why Use Our PDF Signing Tool?</h3>
                    <ul>
                        <li>100% Free - No hidden costs</li>
                        <li>No registration required</li>
                        <li>Secure - Files never leave your browser</li>
                        <li>Works on all devices</li>
                        <li>Legally binding signatures</li>
                    </ul>
                </div>

                <div class="ad-container">
                    <div class="ad-header">Advertisement</div>
                    <div class="ad-content">
                        <!-- Google AdSense Ad Unit -->
                        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-XXXXXXXXXXXXXXXX" crossorigin="anonymous"></script>
                        <ins class="adsbygoogle"
                             style="display:block"
                             data-ad-client="ca-pub-XXXXXXXXXXXXXXXX"
                             data-ad-slot="XXXXXXXXXX"
                             data-ad-format="auto"
                             data-full-width-responsive="true"></ins>
                        <script>
                             (adsbygoogle = window.adsbygoogle || []).push({});
                        </script>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>SignPDF Pro</h3>
                    <p>The easiest way to sign PDF documents online. Free, secure, and no registration required.</p>
                </div>
                <div class="footer-section">
                    <h3>Quick Links</h3>
                    <ul>
                        <li><a href="#">Home</a></li>
                        <li><a href="#">How It Works</a></li>
                        <li><a href="#">Features</a></li>
                        <li><a href="#">Privacy Policy</a></li>
                        <li><a href="#">Terms of Service</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h3>Tools</h3>
                    <ul>
                        <li><a href="#">PDF Signer</a></li>
                        <li><a href="#">PDF Merger</a></li>
                        <li><a href="#">PDF Splitter</a></li>
                        <li><a href="#">PDF Compressor</a></li>
                        <li><a href="#">PDF Converter</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h3>Contact Us</h3>
                    <ul>
                        <li><a href="#"><i class="fas fa-envelope"></i> support@signpdfpro.com</a></li>
                        <li><a href="#"><i class="fas fa-globe"></i> www.signpdfpro.com</a></li>
                    </ul>
                </div>
            </div>
            <div class="copyright">
                &copy; 2023 SignPDF Pro. All rights reserved.
            </div>
        </div>
    </footer>

    <script>
        // DOM Elements
        const steps = document.querySelectorAll('.step');
        const progressBar = document.getElementById('progressBar');
        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('fileInput');
        const fileInfo = document.getElementById('fileInfo');
        const fileName = document.getElementById('fileName');
        const fileSize = document.getElementById('fileSize');
        const browseBtn = document.getElementById('browseBtn');
        const continueBtn1 = document.getElementById('continueBtn1');
        const signatureOptions = document.querySelectorAll('.signature-option');
        const signatureMethods = document.querySelectorAll('.signature-method');
        const backBtn1 = document.getElementById('backBtn1');
        const continueBtn2 = document.getElementById('continueBtn2');
        const previewContainer = document.getElementById('previewContainer');
        const signaturePosition = document.getElementById('signaturePosition');
        const backBtn2 = document.getElementById('backBtn2');
        const continueBtn3 = document.getElementById('continueBtn3');
        const successMessage = document.getElementById('successMessage');
        const downloadBtn = document.getElementById('downloadBtn');
        const newDocumentBtn = document.getElementById('newDocumentBtn');
        const clearCanvas = document.getElementById('clearCanvas');
        const undoCanvas = document.getElementById('undoCanvas');
        const penColor = document.getElementById('penColor');
        const penWidth = document.getElementById('penWidth');
        const signatureText = document.getElementById('signatureText');
        const signatureFont = document.getElementById('signatureFont');
        const typedSignaturePreview = document.getElementById('typedSignaturePreview');
        const signatureUploadArea = document.getElementById('signatureUploadArea');
        const signatureFileInput = document.getElementById('signatureFileInput');
        const browseSignatureBtn = document.getElementById('browseSignatureBtn');
        const signatureFileInfo = document.getElementById('signatureFileInfo');
        const signatureFileName = document.getElementById('signatureFileName');
        const signaturePreview = document.getElementById('signaturePreview');
        const mobileNavToggle = document.querySelector('.mobile-nav-toggle');
        const navMenu = document.querySelector('.nav-menu');

        // State variables
        let currentStep = 1;
        let selectedFile = null;
        let signatureType = 'draw';
        let signatureData = null;
        let canvas = null;
        let ctx = null;
        let isDrawing = false;
        let lastX = 0;
        let lastY = 0;
        let canvasHistory = [];
        let currentHistoryIndex = -1;

        // Initialize the application
        function init() {
            setupEventListeners();
            initializeCanvas();
            updateProgressBar();
        }

        // Set up event listeners
        function setupEventListeners() {
            // File upload
            uploadArea.addEventListener('click', () => fileInput.click());
            uploadArea.addEventListener('dragover', handleDragOver);
            uploadArea.addEventListener('drop', handleFileDrop);
            browseBtn.addEventListener('click', () => fileInput.click());
            fileInput.addEventListener('change', handleFileSelect);
            continueBtn1.addEventListener('click', goToStep2);

            // Signature options
            signatureOptions.forEach(option => {
                option.addEventListener('click', () => selectSignatureType(option.dataset.type));
            });

            // Navigation
            backBtn1.addEventListener('click', goToStep1);
            continueBtn2.addEventListener('click', goToStep3);
            backBtn2.addEventListener('click', goToStep2);
            continueBtn3.addEventListener('click', processSigning);
            downloadBtn.addEventListener('click', downloadSignedPDF);
            newDocumentBtn.addEventListener('click', resetTool);

            // Canvas controls
            clearCanvas.addEventListener('click', clearSignatureCanvas);
            undoCanvas.addEventListener('click', undoCanvasAction);
            penColor.addEventListener('change', updatePenSettings);
            penWidth.addEventListener('change', updatePenSettings);

            // Typed signature
            signatureText.addEventListener('input', updateTypedSignature);
            signatureFont.addEventListener('change', updateTypedSignature);

            // Upload signature
            signatureUploadArea.addEventListener('click', () => signatureFileInput.click());
            browseSignatureBtn.addEventListener('click', () => signatureFileInput.click());
            signatureFileInput.addEventListener('change', handleSignatureFileSelect);

            // Mobile navigation
            mobileNavToggle.addEventListener('click', toggleMobileNav);
        }

        // Initialize canvas for drawing signature
        function initializeCanvas() {
            canvas = document.getElementById('signatureCanvas');
            ctx = canvas.getContext('2d');
            
            // Set canvas size
            canvas.width = canvas.offsetWidth;
            canvas.height = canvas.offsetHeight;
            
            // Set initial canvas style
            ctx.strokeStyle = 'black';
            ctx.lineWidth = 4;
            ctx.lineCap = 'round';
            ctx.lineJoin = 'round';
            
            // Add event listeners for drawing
            canvas.addEventListener('mousedown', startDrawing);
            canvas.addEventListener('mousemove', draw);
            canvas.addEventListener('mouseup', stopDrawing);
            canvas.addEventListener('mouseout', stopDrawing);
            
            // Touch events for mobile devices
            canvas.addEventListener('touchstart', handleTouchStart);
            canvas.addEventListener('touchmove', handleTouchMove);
            canvas.addEventListener('touchend', stopDrawing);
        }

        // Canvas drawing functions
        function startDrawing(e) {
            isDrawing = true;
            [lastX, lastY] = getCoordinates(e);
            saveCanvasState();
        }

        function draw(e) {
            if (!isDrawing) return;
            
            const [x, y] = getCoordinates(e);
            
            ctx.beginPath();
            ctx.moveTo(lastX, lastY);
            ctx.lineTo(x, y);
            ctx.stroke();
            
            [lastX, lastY] = [x, y];
        }

        function stopDrawing() {
            isDrawing = false;
        }

        function getCoordinates(e) {
            let x, y;
            
            if (e.type.includes('touch')) {
                x = e.touches[0].clientX - canvas.getBoundingClientRect().left;
                y = e.touches[0].clientY - canvas.getBoundingClientRect().top;
            } else {
                x = e.offsetX;
                y = e.offsetY;
            }
            
            return [x, y];
        }

        function handleTouchStart(e) {
            e.preventDefault();
            startDrawing(e);
        }

        function handleTouchMove(e) {
            e.preventDefault();
            draw(e);
        }

        function clearSignatureCanvas() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            canvasHistory = [];
            currentHistoryIndex = -1;
        }

        function undoCanvasAction() {
            if (currentHistoryIndex > 0) {
                currentHistoryIndex--;
                const imageData = canvasHistory[currentHistoryIndex];
                ctx.putImageData(imageData, 0, 0);
            } else {
                clearSignatureCanvas();
            }
        }

        function saveCanvasState() {
            // Only keep the last 10 states for memory management
            if (canvasHistory.length >= 10) {
                canvasHistory.shift();
                currentHistoryIndex--;
            }
            
            const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            canvasHistory.push(imageData);
            currentHistoryIndex = canvasHistory.length - 1;
        }

        function updatePenSettings() {
            ctx.strokeStyle = penColor.value;
            ctx.lineWidth = parseInt(penWidth.value);
        }

        // File handling
        function handleDragOver(e) {
            e.preventDefault();
            uploadArea.style.borderColor = 'var(--primary)';
            uploadArea.style.backgroundColor = 'rgba(67, 97, 238, 0.05)';
        }

        function handleFileDrop(e) {
            e.preventDefault();
            uploadArea.style.borderColor = '#d1d5db';
            uploadArea.style.backgroundColor = 'transparent';
            
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                processFile(files[0]);
            }
        }

        function handleFileSelect(e) {
            const files = e.target.files;
            if (files.length > 0) {
                processFile(files[0]);
            }
        }

        function processFile(file) {
            if (file.type !== 'application/pdf') {
                alert('Please select a PDF file.');
                return;
            }
            
            if (file.size > 10 * 1024 * 1024) {
                alert('File size must be less than 10MB.');
                return;
            }
            
            selectedFile = file;
            fileName.textContent = file.name;
            fileSize.textContent = `Size: ${(file.size / 1024 / 1024).toFixed(2)} MB`;
            fileInfo.classList.add('active');
        }

        function handleSignatureFileSelect(e) {
            const files = e.target.files;
            if (files.length > 0) {
                const file = files[0];
                if (!file.type.match('image.*')) {
                    alert('Please select an image file.');
                    return;
                }
                
                signatureFileName.textContent = file.name;
                signatureFileInfo.classList.add('active');
                
                // Create a preview of the signature
                const reader = new FileReader();
                reader.onload = function(e) {
                    signatureData = e.target.result;
                    signaturePreview.innerHTML = `<img src="${signatureData}" style="max-width: 100%; max-height: 100%;">`;
                };
                reader.readAsDataURL(file);
            }
        }

        // Signature type selection
        function selectSignatureType(type) {
            signatureType = type;
            
            // Update active option
            signatureOptions.forEach(option => {
                if (option.dataset.type === type) {
                    option.classList.add('active');
                } else {
                    option.classList.remove('active');
                }
            });
            
            // Show corresponding method
            signatureMethods.forEach(method => {
                if (method.id === `${type}Method`) {
                    method.style.display = 'block';
                } else {
                    method.style.display = 'none';
                }
            });
            
            // Reset signature data when switching methods
            signatureData = null;
            
            // Initialize signature data based on type
            if (type === 'draw') {
                // Canvas is already initialized
            } else if (type === 'type') {
                updateTypedSignature();
            } else if (type === 'upload') {
                // File upload will handle it
            }
        }

        function updateTypedSignature() {
            const text = signatureText.value || 'Your Name';
            const font = signatureFont.value;
            
            typedSignaturePreview.textContent = text;
            typedSignaturePreview.style.fontFamily = font;
            
            // Store the signature data
            signatureData = {
                text: text,
                font: font
            };
        }

        // Step navigation
        function goToStep1() {
            showStep(1);
        }

        function goToStep2() {
            if (!selectedFile) {
                alert('Please select a PDF file first.');
                return;
            }
            
            showStep(2);
        }

        function goToStep3() {
            // Validate signature based on type
            if (signatureType === 'draw') {
                // Check if canvas has content
                const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
                const blank = new ImageData(canvas.width, canvas.height);
                
                if (JSON.stringify(imageData.data) === JSON.stringify(blank.data)) {
                    alert('Please draw your signature first.');
                    return;
                }
                
                // Convert canvas to data URL
                signatureData = canvas.toDataURL();
            } else if (signatureType === 'type') {
                if (!signatureText.value.trim()) {
                    alert('Please enter your name for the signature.');
                    return;
                }
            } else if (signatureType === 'upload') {
                if (!signatureData) {
                    alert('Please upload a signature image first.');
                    return;
                }
            }
            
            // Update signature preview
            if (signatureType === 'draw') {
                signaturePreview.innerHTML = `<img src="${signatureData}" style="max-width: 100%; max-height: 100%;">`;
            } else if (signatureType === 'type') {
                signaturePreview.innerHTML = `<div style="font-family: '${signatureData.font}'; font-size: 1.5rem; padding: 10px;">${signatureData.text}</div>`;
            }
            
            // Show the signature position element
            signaturePosition.style.display = 'block';
            
            // Initialize drag functionality for signature positioning
            initSignatureDragging();
            
            showStep(3);
        }

        function showStep(stepNumber) {
            steps.forEach(step => {
                step.classList.remove('active');
            });
            
            document.getElementById(`step${stepNumber}`).classList.add('active');
            currentStep = stepNumber;
            updateProgressBar();
        }

        function updateProgressBar() {
            const progress = (currentStep / 3) * 100;
            progressBar.style.width = `${progress}%`;
        }

        function initSignatureDragging() {
            let isDragging = false;
            let offsetX, offsetY;
            
            signaturePosition.addEventListener('mousedown', startDrag);
            document.addEventListener('mousemove', drag);
            document.addEventListener('mouseup', stopDrag);
            
            // Touch events for mobile
            signaturePosition.addEventListener('touchstart', startDragTouch);
            document.addEventListener('touchmove', dragTouch);
            document.addEventListener('touchend', stopDrag);
            
            function startDrag(e) {
                isDragging = true;
                offsetX = e.clientX - signaturePosition.offsetLeft;
                offsetY = e.clientY - signaturePosition.offsetTop;
                signaturePosition.style.cursor = 'grabbing';
            }
            
            function startDragTouch(e) {
                isDragging = true;
                offsetX = e.touches[0].clientX - signaturePosition.offsetLeft;
                offsetY = e.touches[0].clientY - signaturePosition.offsetTop;
                e.preventDefault();
            }
            
            function drag(e) {
                if (!isDragging) return;
                
                const x = e.clientX - offsetX;
                const y = e.clientY - offsetY;
                
                // Constrain to preview container
                const containerRect = previewContainer.getBoundingClientRect();
                const signatureRect = signaturePosition.getBoundingClientRect();
                
                const maxX = containerRect.width - signatureRect.width;
                const maxY = containerRect.height - signatureRect.height;
                
                signaturePosition.style.left = `${Math.max(0, Math.min(x, maxX))}px`;
                signaturePosition.style.top = `${Math.max(0, Math.min(y, maxY))}px`;
            }
            
            function dragTouch(e) {
                if (!isDragging) return;
                
                const x = e.touches[0].clientX - offsetX;
                const y = e.touches[0].clientY - offsetY;
                
                // Constrain to preview container
                const containerRect = previewContainer.getBoundingClientRect();
                const signatureRect = signaturePosition.getBoundingClientRect();
                
                const maxX = containerRect.width - signatureRect.width;
                const maxY = containerRect.height - signatureRect.height;
                
                signaturePosition.style.left = `${Math.max(0, Math.min(x, maxX))}px`;
                signaturePosition.style.top = `${Math.max(0, Math.min(y, maxY))}px`;
                
                e.preventDefault();
            }
            
            function stopDrag() {
                isDragging = false;
                signaturePosition.style.cursor = 'move';
            }
        }

        function processSigning() {
            // In a real implementation, this would use a PDF library like pdf-lib or pdf.js
            // to actually add the signature to the PDF
            
            // For this demo, we'll just simulate the process
            setTimeout(() => {
                // Hide step 3 and show success message
                document.getElementById('step3').style.display = 'none';
                successMessage.style.display = 'block';
            }, 1500);
        }

        function downloadSignedPDF() {
            // In a real implementation, this would download the actual signed PDF
            // For this demo, we'll create a dummy download
            
            const blob = new Blob(['This is a simulation of a signed PDF file. In a real implementation, this would be the actual signed PDF.'], { type: 'application/pdf' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'signed-document.pdf';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function resetTool() {
            // Reset all state
            selectedFile = null;
            signatureType = 'draw';
            signatureData = null;
            
            // Reset UI
            fileInput.value = '';
            fileInfo.classList.remove('active');
            clearSignatureCanvas();
            signatureText.value = '';
            signatureFont.value = 'Dancing Script';
            updateTypedSignature();
            signatureFileInput.value = '';
            signatureFileInfo.classList.remove('active');
            signaturePosition.style.display = 'none';
            signaturePosition.style.left = '50px';
            signaturePosition.style.top = '50px';
            
            // Show step 1
            document.getElementById('step3').style.display = 'block';
            successMessage.style.display = 'none';
            showStep(1);
        }

        function toggleMobileNav() {
            navMenu.classList.toggle('active');
        }

        // Initialize the application when DOM is loaded
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
